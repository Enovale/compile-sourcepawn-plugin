"use strict";var n=require("path"),o=require("@actions/core"),u=require("@actions/exec"),l=require("@actions/http-client"),i=require("@actions/tool-cache");function d(){return process.platform==="linux"}function p(){let t=["1.11","1.12"],e=(0,o.getInput)("sourcemod",{required:!1});if(!t.includes(e))throw new TypeError("sourcemod parameter must bem 1.11 or 1.12");return e}async function f(t){let e=new l.HttpClient("smdrop"),s=d()?"sourcemod-latest-linux":"sourcemod-latest-windows",r=await(await e.get(`https://sm.alliedmods.net/smdrop/${t}/${s}`)).readBody(),c=await(0,i.downloadTool)(`https://sm.alliedmods.net/smdrop/${t}/${r}`),m=await(d()?i.extractTar:i.extractZip)(c);return(0,o.addPath)((0,n.join)(m,"addons","sourcemod","scripting")),(0,n.join)(m,"addons","sourcemod")}async function w(...t){let e=t.filter(Boolean).join(" "),s=await(0,u.exec)(e);if(s!==0)throw new Error(`command exited with ${s}`)}async function x(){let t=(0,o.getInput)("input",{required:!0}),e=(0,o.getInput)("output",{required:!0}),s=(0,o.getInput)("includes",{required:!1}).split(/\s/g).filter(Boolean).map(r=>`-i ${r}`).join(" ");try{let r=p(),c=await f(r),a=(0,n.join)(c,"scripting","include");await w("spcomp64",t,`-o ${e}`,`-i ${a}`,s,"-O2 -v2")}catch(r){(0,o.setFailed)(`Action failed: ${r.message}`)}}x();
