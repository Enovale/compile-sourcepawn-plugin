"use strict";var i=require("path"),o=require("@actions/core"),u=require("@actions/exec"),l=require("@actions/http-client"),s=require("@actions/tool-cache");function d(){return process.platform==="linux"}function p(){let e=["1.11","1.12"],r=(0,o.getInput)("sm_version",{required:!1});if(!e.includes(r))throw new TypeError("sm_version must bem 1.11 or 1.12");return r}async function f(e){let r=new l.HttpClient("smdrop"),n=d()?"sourcemod-latest-linux":"sourcemod-latest-windows",t=await(await r.get(`https://sm.alliedmods.net/smdrop/${e}/${n}`)).readBody(),c=await(0,s.downloadTool)(`https://sm.alliedmods.net/smdrop/${e}/${t}`),m=await(d()?s.extractTar:s.extractZip)(c);return(0,o.addPath)((0,i.join)(m,"addons","sourcemod","scripting")),(0,i.join)(m,"addons","sourcemod")}async function w(){let e=(0,o.getInput)("plugin_src_path",{required:!0}),r=(0,o.getInput)("plugin_smx_path",{required:!0}),n=(0,o.getInput)("includes_src",{required:!1}).split(/\s/g).filter(Boolean).map(t=>`-i ${t}`).join(" ");try{let t=p(),c=await f(t),a=(0,i.join)(c,"scripting","include");await(0,u.exec)(`spcomp64 ${e} -o ${r} -i ${a} ${n} -O2 -v2`)}catch(t){(0,o.setFailed)(`Action failed: ${t.message}`)}}w();
